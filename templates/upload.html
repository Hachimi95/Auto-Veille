{% extends 'base.html' %}
{% block title %}Upload | Auto-Veille{% endblock %}
{% block content %}
<section class="container" style="max-width:600px; margin:0 auto; padding: 2rem; background: var(--card-bg); border-radius: var(--radius); box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">
  <h2 style="text-align:center; margin-bottom: 1.5rem; color: var(--primary-color);">Upload PDF Bulletins</h2>
  <form id="upload-form" method="post" enctype="multipart/form-data" style="display: flex; flex-direction: column; gap: 1rem;">
    <div id="drop-area" style="border: 2px dashed var(--primary-color); border-radius: var(--radius); padding: 2rem; text-align: center; background: #f5f5f5; transition: border-color .2s; cursor: pointer;">
      <span style="font-size: 2.5em;">ðŸ“„</span>
      <p id="file-name" style="margin-top: 0.5rem; color: #555; font-size:1.08em;">Drag and drop your PDF files here or click to select</p>
      <input type="file" id="pdf" name="pdf" accept="application/pdf" multiple style="display: none;">
    </div>
    <button class="btn" type="submit">Upload</button>
    <p style="color: #777; font-size: 1em; text-align: center;">Only PDF files are accepted. Automatic data extraction on import.</p>
  </form>
</section>
{% endblock %}
{% block scripts %}
<style>
  #file-name.selected {
    color: #764ba2;
    font-weight: 600;
    font-size: 1.12em;
    margin-top: 1em;
  }
</style>
<script>
const dropArea = document.getElementById('drop-area');
const fileInput = document.getElementById('pdf');
const fileName = document.getElementById('file-name');

dropArea.addEventListener('click', () => fileInput.click());
dropArea.addEventListener('dragover', e => { e.preventDefault(); dropArea.style.borderColor = 'var(--secondary-color)'; });
dropArea.addEventListener('dragleave', e => { e.preventDefault(); dropArea.style.borderColor = 'var(--primary-color)'; });
dropArea.addEventListener('drop', e => {
  e.preventDefault();
  dropArea.style.borderColor = 'var(--primary-color)';
  fileInput.files = e.dataTransfer.files;
  if (fileInput.files.length > 0) {
    if (fileInput.files.length === 1) {
      fileName.textContent = `File selected: ${fileInput.files[0].name}`;
    } else {
      fileName.textContent = `${fileInput.files.length} files selected: ` + Array.from(fileInput.files).map(f => f.name).join(', ');
    }
    fileName.classList.add('selected');
  } else {
    fileName.textContent = 'Drag and drop your PDF files here or click to select';
    fileName.classList.remove('selected');
  }
});
fileInput.addEventListener('change', function() {
  if (fileInput.files.length > 0) {
    if (fileInput.files.length === 1) {
      fileName.textContent = `File selected: ${fileInput.files[0].name}`;
    } else {
      fileName.textContent = `${fileInput.files.length} files selected: ` + Array.from(fileInput.files).map(f => f.name).join(', ');
    }
    fileName.classList.add('selected');
  } else {
    fileName.textContent = 'Drag and drop your PDF files here or click to select';
    fileName.classList.remove('selected');
  }
});
document.getElementById('upload-form').addEventListener('submit', function(e) {
  if (!fileInput.files.length) {
    showToast('Please select at least one PDF file.', 'error');
    e.preventDefault();
  }
});
</script>
{% endblock %}